---
import { getCollection } from 'astro:content';
import BaseHead from '../../components/BaseHead.astro';
import NavigationBar from '../../components/NavigationBar.astro';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = await getCollection('blog');
const sortedPosts = posts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<html lang="en">
	<head>
		<BaseHead 
			title="Blog - keinsell" 
			description="Personal blog posts about software engineering, technology, and life experiences"
		/>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}
			body {
				font-family: monospace;
				font-size: 12px;
				line-height: 1.4;
				color: #000;
				background: #fff;
				display: flex;
				flex-direction: column;
				min-height: 100vh;
			}
			.container {
				padding: 10px 20px;
				max-width: 800px;
				margin: 0 auto;
				flex: 1;
				display: flex;
				flex-direction: column;
			}
			.page-header {
				margin-bottom: 30px;
				padding-bottom: 20px;
				border-bottom: 1px solid #ccc;
			}
			.page-header h1 {
				font-size: 24px;
				font-weight: bold;
				margin-bottom: 10px;
			}
			.page-description {
				font-size: 13px;
				color: #333;
			}
			.back-link {
				margin-bottom: 20px;
			}
			.back-link a {
				color: #0000ff;
				text-decoration: underline;
				font-size: 12px;
			}
			.back-link a:hover {
				background: #0000ff;
				color: #fff;
				text-decoration: none;
			}
			.blog-list {
				list-style: none;
			}
			.blog-item {
				margin-bottom: 25px;
				padding-bottom: 20px;
				border-bottom: 1px solid #eee;
			}
			.blog-item:last-child {
				border-bottom: none;
			}
			.blog-item h2 {
				font-size: 16px;
				font-weight: bold;
				margin-bottom: 8px;
			}
			.blog-item h2 a {
				color: #000;
				text-decoration: none;
			}
			.blog-item h2 a:hover {
				color: #0000ff;
				text-decoration: underline;
			}
			.blog-meta {
				font-size: 11px;
				color: #666;
				margin-bottom: 8px;
			}
			.blog-description {
				font-size: 12px;
				color: #333;
				line-height: 1.5;
			}
			.read-more {
				margin-top: 8px;
			}
			.read-more a {
				color: #0000ff;
				text-decoration: underline;
				font-size: 11px;
			}
			.read-more a:hover {
				background: #0000ff;
				color: #fff;
				text-decoration: none;
			}
			.no-posts {
				text-align: center;
				color: #666;
				font-style: italic;
				margin: 40px 0;
			}
			@media (prefers-color-scheme: dark) {
				body {
					background: #1a1a1a;
					color: #ccc;
				}
				.page-header {
					border-color: #333;
				}
				.page-description {
					color: #aaa;
				}
				.back-link a {
					color: #88f;
				}
				.back-link a:hover {
					background: #88f;
					color: #000;
				}
				.blog-item {
					border-color: #333;
				}
				.blog-item h2 a {
					color: #ccc;
				}
				.blog-item h2 a:hover {
					color: #88f;
				}
				.blog-meta {
					color: #999;
				}
				.blog-description {
					color: #aaa;
				}
				.read-more a {
					color: #88f;
				}
				.read-more a:hover {
					background: #88f;
					color: #000;
				}
				.no-posts {
					color: #999;
				}
			}
		</style>
	</head>
	<body>
		<NavigationBar />
		<div class="container">
			{sortedPosts.length > 0 ? (
				<ul class="blog-list">
					{sortedPosts.map((post) => (
						<li class="blog-item">
							<h2>
								<a href={`/blog/${post.id}`}>{post.data.title}</a>
							</h2>
							<div class="blog-meta">
								<FormattedDate date={post.data.pubDate} />
							</div>
							{post.data.description && (
								<div class="blog-description">
									{post.data.description}
								</div>
							)}
							<div class="read-more">
								<a href={`/blog/${post.id}`}>Read more â†’</a>
							</div>
						</li>
					))}
				</ul>
			) : (
				<div class="no-posts">
					No blog posts available yet.
				</div>
			)}
		</div>
	</body>
</html>
