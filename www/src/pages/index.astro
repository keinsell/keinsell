---
import { getCollection } from 'astro:content';
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from '../components/FormattedDate.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
).slice(0, 3);
---

<html lang="en">
    <head>
        <BaseHead title="keinsell" description="journey through the desert" />
    </head>
    <body class="min-h-screen bg-background">
        <Header />
        <main class="container mx-auto px-4 py-12 max-w-4xl">
            <!-- Hero Section -->
            <section class="mb-16 text-center">
                <h1 class="text-5xl font-bold tracking-tight mb-6">
                    Welcome to my digital garden
                </h1>
                <p class="text-xl text-muted-foreground mb-8 max-w-2xl mx-auto leading-relaxed">
                    Journey through the desert of technology, development, and ideas. 
                    There will be eldorado, but now we build with passion.
                </p>
                <div class="flex gap-4 justify-center">
                    <a href="/blog" class="btn btn-primary">
                        Read the blog
                    </a>
                    <a href="/story" class="btn btn-secondary">
                        My story
                    </a>
                </div>
            </section>

            <!-- Featured Posts -->
            <section class="mb-16">
                <div class="flex items-center justify-between mb-8">
                    <h2 class="text-3xl font-semibold tracking-tight">Latest Posts</h2>
                    <a href="/blog" class="btn btn-ghost">
                        View all →
                    </a>
                </div>
                
                <div class="grid gap-6">
                    {posts.map((post) => (
                        <article class="card p-6 hover:shadow-md transition-shadow">
                            <div class="flex flex-col md:flex-row gap-6">
                                {post.data.heroImage && (
                                    <div class="md:w-1/3">
                                        <div class="aspect-video overflow-hidden rounded-lg bg-muted">
                                            <img 
                                                src={post.data.heroImage} 
                                                alt={post.data.title}
                                                class="object-cover w-full h-full hover:scale-105 transition-transform duration-300"
                                            />
                                        </div>
                                    </div>
                                )}
                                
                                <div class="flex-1 flex flex-col space-y-3">
                                    <div class="flex items-center space-x-2 text-sm text-muted-foreground">
                                        <FormattedDate date={post.data.pubDate} />
                                        <span>•</span>
                                        <span>5 min read</span>
                                    </div>
                                    
                                    <h3 class="text-xl font-semibold tracking-tight">
                                        <a 
                                            href={`/blog/${post.slug}/`}
                                            class="hover:text-primary transition-colors"
                                        >
                                            {post.data.title}
                                        </a>
                                    </h3>
                                    
                                    <p class="text-muted-foreground leading-relaxed">
                                        {post.data.description}
                                    </p>
                                    
                                    <div class="flex items-center justify-between pt-2">
                                        <a 
                                            href={`/blog/${post.slug}/`}
                                            class="btn btn-ghost text-sm"
                                        >
                                            Read more →
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </article>
                    ))}
                </div>
            </section>
        </main>
        <Footer />
    </body>
</html>